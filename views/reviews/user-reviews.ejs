<% if (title) { %>
  <h1><%= title %></h1>
<% } else { res.redirect('/') } %>

<%- messages() %>

<div class="user-reviews-container">
  <p class="review-intro">Manage all your vehicle reviews in one place.</p>
  
  <% if (reviews && reviews.length > 0) { %>
    <div class="user-reviews-list">
      <% reviews.forEach(review => { %>
        <article class="user-review-card">
          <div class="review-vehicle-info">
            <h2>
              <a href="/inv/detail/<%= review.inv_id %>">
                <%= review.inv_year %> <%= review.inv_make %> <%= review.inv_model %>
              </a>
            </h2>
          </div>
          
          <div class="review-content">
            <div class="review-rating">
              <% for(let i = 0; i < review.review_rating; i++) { %>★<% } %>
              <% for(let i = review.review_rating; i < 5; i++) { %>☆<% } %>
              <span class="rating-text">(<%= review.review_rating %> / 5)</span>
            </div>
            
            <p class="review-text"><%= review.review_text %></p>
            
            <div class="review-metadata">
              <span class="review-date">
                Posted: <%= new Date(review.review_date).toLocaleDateString('en-US', { 
                  year: 'numeric', 
                  month: 'long', 
                  day: 'numeric' 
                }) %>
              </span>
              <% if (review.updated_at && review.updated_at !== review.review_date) { %>
                <span class="review-updated">
                  (Updated: <%= new Date(review.updated_at).toLocaleDateString('en-US', { 
                    year: 'numeric', 
                    month: 'long', 
                    day: 'numeric' 
                  }) %>)
                </span>
              <% } %>
            </div>
          </div>
          
          <div class="review-actions">
            <a href="/reviews/edit/<%= review.review_id %>" class="btn-edit">Edit Review</a>
            <a href="/reviews/delete/<%= review.review_id %>" class="btn-delete"
               onclick="return confirm('Are you sure you want to delete this review? This action cannot be undone.')">
              Delete Review
            </a>
          </div>
        </article>
      <% }) %>
    </div>
  <% } else { %>
    <div class="no-reviews-message">
      <p>You haven't written any reviews yet.</p>
      <p><a href="/inv">Browse vehicles</a> to find one you'd like to review!</p>
    </div>
  <% } %>
</div>

