<% if (title) { %>
  <h1><%= title %></h1>
<% } else { res.redirect('/') } %>

<div class="review-container">
  <div class="vehicle-summary">
    <h2><%= vehicle.inv_year %> <%= vehicle.inv_make %> <%= vehicle.inv_model %></h2>
  </div>

  <%- messages() %>

  <% if (errors) { %>
    <ul class="notice">
      <% errors.forEach(error => { %>
        <li><%= error.msg %></li>
      <% }) %>
    </ul>
  <% } %>

  <form action="/reviews/update" method="POST" class="review-form">
    <input type="hidden" name="review_id" value="<%= review.review_id %>">
    
    <fieldset>
      <legend>Edit Your Review</legend>
      
      <label for="rating">Rating *</label>
      <select name="rating" id="rating" required>
        <option value="5" <%= review.review_rating == 5 ? 'selected' : '' %>>★★★★★ Excellent</option>
        <option value="4" <%= review.review_rating == 4 ? 'selected' : '' %>>★★★★☆ Very Good</option>
        <option value="3" <%= review.review_rating == 3 ? 'selected' : '' %>>★★★☆☆ Good</option>
        <option value="2" <%= review.review_rating == 2 ? 'selected' : '' %>>★★☆☆☆ Fair</option>
        <option value="1" <%= review.review_rating == 1 ? 'selected' : '' %>>★☆☆☆☆ Poor</option>
      </select>

      <label for="review_text">Your Review * (10-1000 characters)</label>
      <textarea name="review_text" id="review_text" rows="8" required><%= review.review_text %></textarea>
      
      <div class="form-actions">
        <input type="submit" value="Update Review" class="submit-btn">
        <a href="/inv/detail/<%= vehicle.inv_id %>" class="cancel-btn">Cancel</a>
        <a href="/reviews/delete/<%= review.review_id %>" class="delete-btn" 
           onclick="return confirm('Are you sure you want to delete this review? This action cannot be undone.')">
          Delete Review
        </a>
      </div>
    </fieldset>
  </form>
</div>